app: ke.mic.wireguide
ingredients:
  dist: groovy
  sources:
    - deb http://us.archive.ubuntu.com/ubuntu/ groovy groovy-updates groovy-security main universe
    - deb http://us.archive.ubuntu.com/ubuntu/ groovy-updates main universe
    - deb http://us.archive.ubuntu.com/ubuntu/ groovy-security main universe
  script:
    - wget -c https://github.com/mickenordin/wireguide/blob/main/wireguide/logo.png -O ke.mic.wireguide.png
    - wget -c https://github.com/mickenordin/wireguide/blob/main/appimage/wireguide.appdata.xml -O wireguide.appdata.xml
  packages:
    - python3-pip
    - python3-gi
    - python3-wxgtk4.0
    - python3-sip
    - libnm0
    - gir1.2-nm-1.0
script:
  - ./usr/bin/pip3 install WireGUIde==0.0.6
  - cp ../ke.mic.wireguide.png ./usr/share/icons/hicolor/256x256/
  - cp ../ke.mic.wireguide.png .
  - mkdir -p usr/share/metainfo/ ; cp ../wireguide.appdata.xml usr/share/metainfo/
  - cat > usr/share/applications/ke.mic.wireguide.desktop <<\EOF
  - [Desktop Entry]
  - Type=Application
  - Name=WireGUIde
  - Comment=A GUI for WireGuard
  - Icon=ke.mic.wireguide
  - Exec=python3 /usr/local/bin/wireguide
  - Terminal=false
  - Categories=Application;
  - Keywords=Python;
  - MimeType=text/x-python3;
  - EOF
  - cp usr/share/applications/ke.mic.wireguide.desktop .
  - usr/bin/pip3 freeze | grep "wireguide" | cut -d "=" -f 3  >> ../VERSION

